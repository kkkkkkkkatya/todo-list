{% extends "base.html" %}

{% block content %}
  <div class="container">
    <h1 class="d-flex justify-content-between align-items-center mt-4">TODO list
      <a href="{% url 'todo:task-create' %}" class="btn btn-primary float-end">Add task</a>
    </h1>

    <div class="row">
      <div class="col-md-9">
        {% for task in task_list %}
          <div class="card mb-3">
            <div class="card-body d-flex justify-content-between align-items-center">
              <!-- Left side (Task details) -->
              <div>
                <h4 class="card-title">
                  <strong>{{ task.content }}</strong>
                  {% if not task.is_done %}
                    <span class="text-danger">Not done</span>
                  {% else %}
                    <span class="text-success">Done</span>
                  {% endif %}
                </h4>

                <p class="card-text text-muted">
                  Created: {{ task.created_at|date:"F d, Y, g:i a" }}
                  {% if task.deadline %}
                    | <strong>Deadline:</strong> {{ task.deadline|date:"F d, Y, g:i a" }}
                  {% endif %}
                </p>

                <p><strong>Tags:</strong>
                  {% for tag in task.tags.all %}
                    <span class="badge bg-secondary">{{ tag.name }}</span>
                  {% endfor %}
                </p>

                <a href="{% url 'todo:task-update' pk=task.id %}" class="btn btn-link">Update</a>
                <a href="{% url 'todo:task-delete' pk=task.id %}" class="btn btn-link text-danger">Delete</a>
              </div>

              <!-- Right side (Undo/Complete button) -->
              <form action="{% url 'todo:task-toggle' task.pk %}" method="post">
                {% csrf_token %}
                <button type="submit" class="btn btn-secondary ">
                  {% if task.is_done %}Undo{% else %}Complete{% endif %}
                </button>
              </form>

            </div>
          </div>
        {% empty %}
          <p class="text-muted">No tasks yet.</p>
        {% endfor %}
      </div>

    </div>
  </div>
{% endblock %}
